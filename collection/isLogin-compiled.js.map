{"version":3,"sources":["isLogin.js"],"names":[],"mappings":";;AAAA;AACA,IAAI,OAAO,QAAQ,iBAAR,CAAX;AACA;AACA,QAAQ,KAAR,GAAgB,UAAC,GAAD,EAAK,GAAL,EAAS,IAAT,EAAkB;AAChC;AACA,MAAG,IAAI,OAAJ,CAAY,QAAf,EAAwB;AACtB,WAAO,IAAI,QAAJ,CAAa,GAAb,CAAP;AACD;AACD;AACD,CAND;AAOA;AACA,QAAQ,OAAR,GAAkB,UAAC,GAAD,EAAK,GAAL,EAAS,IAAT,EAAkB;AAClC;AACA,MAAG,CAAC,IAAI,OAAJ,CAAY,QAAhB,EAAyB;AACvB,WAAO,IAAI,QAAJ,CAAa,QAAb,CAAP;AACD;AACD;AACD,CAND;AAOA;AACA,QAAQ,QAAR,GAAmB,UAAC,GAAD,EAAK,GAAL,EAAS,IAAT,EAAkB;AACnC,MAAI,WAAW,IAAI,OAAJ,CAAY,QAA3B;AACA,OAAK,OAAL,CAAa,EAAC,kBAAiB,QAAlB,EAAb,EAAyC,EAAC,wBAAuB,CAAxB,EAA0B,OAAM,CAAhC,EAAzC,EAA4E,UAAC,GAAD,EAAK,YAAL,EAAsB;AAChG,QAAG,GAAH,EAAO;AACL,aAAO,IAAI,IAAJ,CAAS,EAAC,cAAa,OAAd,EAAsB,OAAM,UAA5B,EAAT,CAAP;AACD,KAFD,MAEK;AACH,UAAG,aAAa,KAAb,CAAmB,cAAnB,IAAqC,CAAxC,EAA0C;AACxC;AACD,OAFD,MAEK;AACH,eAAO,KAAP;AACD;AACF;AACF,GAVD;AAWD,CAbD;AAcA;AACA,QAAQ,QAAR,GAAmB,UAAC,GAAD,EAAK,GAAL,EAAS,IAAT,EAAkB;AACnC,MAAI,WAAW,IAAI,OAAJ,CAAY,QAA3B;AACA,OAAK,OAAL,CAAa,EAAC,kBAAiB,QAAlB,EAAb,EAAyC,EAAC,wBAAuB,CAAxB,EAA0B,OAAM,CAAhC,EAAzC,EAA4E,UAAC,GAAD,EAAK,YAAL,EAAsB;AAChG,QAAG,GAAH,EAAO;AACL,aAAO,IAAI,IAAJ,CAAS,EAAC,cAAa,OAAd,EAAsB,OAAM,UAA5B,EAAT,CAAP;AACD,KAFD,MAEK;AACH,UAAG,aAAa,KAAb,CAAmB,cAAnB,GAAoC,CAAvC,EAAyC;AACvC;AACD,OAFD,MAEK;AACH,eAAO,KAAP;AACD;AACF;AACF,GAVD;AAWD,CAbD","file":"isLogin-compiled.js","sourcesContent":["//连接数据库\r\nlet user = require('../modules/user');\r\n//用户已登陆状态\r\nexports.Login = (req,res,next) => {\r\n  //判断session 是否存在\r\n  if(req.session.username){\r\n    return res.redirect('/');\r\n  };\r\n  next();\r\n};\r\n//用户未登陆状态\r\nexports.noLogin = (req,res,next) => {\r\n  //判断session是否存在\r\n  if(!req.session.username){\r\n    return res.redirect('/login');\r\n  };\r\n  next();\r\n};\r\n//ADMIN权限控制\r\nexports.youAdmin = (req,res,next) => {\r\n  let username = req.session.username;\r\n  user.findOne({'admin.username':username},{'admin.validateNumber':1,'_id':1},(err,validateDocs) => {\r\n    if(err){\r\n      return res.json({'postStatus':'error','msg':'无法查询此管理员'});\r\n    }else{\r\n      if(validateDocs.admin.validateNumber >= 2){\r\n        next();\r\n      }else{\r\n        return false;\r\n      }\r\n    }\r\n  })\r\n};\r\n//财务权限控制\r\nexports.youPrics = (req,res,next) => {\r\n  let username = req.session.username;\r\n  user.findOne({'admin.username':username},{'admin.validateNumber':1,'_id':1},(err,validateDocs) => {\r\n    if(err){\r\n      return res.json({'postStatus':'error','msg':'无法查询此管理员'});\r\n    }else{\r\n      if(validateDocs.admin.validateNumber > 1){\r\n        next();\r\n      }else{\r\n        return false;\r\n      }\r\n    }\r\n  })\r\n};"]}